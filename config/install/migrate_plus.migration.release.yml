# Migration metadata
id: release
label: release
description: Migration from MYSQL tables to Drupal core entities

source:
  plugin: release
  track_changes: true
  constants:
    NWR_URL: "http://dramonline.org/albums"
    APPEND_DATE: "-01-01"
  ids:
    id:
      type: integer

# Process plugin
process:
  type:
    plugin: default_value
    default_value: release
  uid:
    - plugin: default_value
      default_value: 2
  title: title
  # field_subtitle: display_subtitle
  field_dram_id: id
  field_legacy_id: legacy_id
  field_active: active
  field_release_tracks:
    plugin: migration_lookup
    migration: track
    source: release_tracks
  # field_release_artwork:
  #   plugin: entity_lookup
  #   entity_type: node
  #   value_key: title
  #   source: label_name

  # field_streaming_approved: streaming_approved
  # field_deprecated: field_deprecated
  # field_digital: digital
  field_recording_label:
    plugin: migration_lookup
    migration: label
    source: label_id
  field_media_liner_notes:
    plugin: migration_lookup
    migration: file_media_liner_notes
    source: file_id
  # field_copyright_agent:
  #   - plugin: migration_lookup
  #     migration: label
  #     source: label_id
  #     no_stub: true
  # field_patent_agent:
  #   - plugin: migration_lookup
  #     migration: label
  #     source: label_id
  #     no_stub: true
  field_vendor_id: vendor_id
  # field_oclc_id: oclc_id
  # field_upc_id: upc_id
  # "field_legacy_url/uri": "@pseudo_link"
  # "field_legacy_url/title": url_code
  pseudo_link_c_line:
    plugin: concat
    source:
      - c_line
      - constants/APPEND_DATE
  pseudo_link_p_line:
    plugin: concat
    source:
      - p_line
      - constants/APPEND_DATE
  # field_date_range_copyright/value: "@pseudo_link_c_line"
  # field_date_range_patent/value: "@pseudo_link_p_line"
  # field_date_range_comp/value: composition_start
  # field_date_range_comp/end_value: composition_end
  # field_date_range_comp_circa: composition_circa
  # field_date_range_record/start: recording_start
  # field_date_range_record/end_value: recording_end
  # field_date_range_record_circa: recording_circa

# Destination plugin
destination:
  plugin: entity:node

migration_dependencies: {}
