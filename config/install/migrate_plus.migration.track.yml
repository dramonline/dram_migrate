# Migration metadata
id: track
label: track
description: Migration from MYSQL tables to Drupal core entities

source:
  plugin: track
  track_changes: true
  ids:
    id:
      type: integer

# Process plugin
process:
  type:
    plugin: default_value
    default_value: track
  uid:
    plugin: default_value
    default_value: 2
  title: title
  field_dram_id: id
  field_legacy_id: legacy_id
  field_personnel/target_id:
    - plugin: migration_lookup
      migration: performer
      no_stub: true
      source: id
    - plugin: extract
      index:
        - "0"
  field_personnel/target_revision_id:
    - plugin: migration_lookup
      migration: performer
      no_stub: true
      source: id
    - plugin: extract
      index:
        - "1"

  # field_personnel:
  #   - plugin: migration_lookup
  #     source: id
  #     migration: performer
  #     no_stub: true
  #   - plugin: sub_process
  #     process:
  #       target_id: "0"
  #       target_revision_id: "1"

  # works for a single row
  field_ensemble:
    - plugin: migration_lookup
      migration: ensemble
      source: ensemble_ids

  # field_ensemble:
  #   - plugin: sub_process
  #     source: performer_ids
  #     process:
  #       target_id:
  #         plugin: migration_lookup
  #         migration: ensemble
  #         source: id

# Destination plugin
destination:
  plugin: entity:node

migration_dependencies: {}
